rules:
- id: CST
  name: Visble Password Audit # just passwords without apostrophes 
  description: Possible sensitive machine generated password
  tags:
  - audit
  - password
  - credscan
  - "playbook/app-keys"
  link: https://guides.spectralops.io/docs/app-keys
  applies_to:
  - ".*$"
  applies_not_to:
  - ".*\\.py$"
  - ".*\\.spectral-discovery\\.json$"
  severity: high
  priority: 10
  pattern_group:
    aggregate: or
    patterns:
    - pattern: "(?i)([[:print:]]{0,25}(passw(?:or)?d|pwd|pword|passphrase|passwrd)[^@'\"â€œ\\[(){\\s,;=:&]{0,20})[=]([[:alnum:]!#$%*+/:?@^_~-]{6,})"
      pattern_type: multi
      out: 3
      out_hint: 2
      test_regex_not:
      # - on: 1
      #   pattern: "" # on key
      - on: 3
        pattern: "(?m)^(true|false|null|pass|password|self|htpasswd|[Nn]one|DOCKER_PASSWORD|[$][[:alnum:]_.-]+|this|PASSWORD|[Pp]assword)$" # exectly 
      - on: 3
        pattern: "([Tt]est|function|[eE]xample|SECRET|[Ss]ecret|[*][*][*])" # included
      - on: 1
        pattern: "[$]this[-][>]|public|title|\\.file|MaskingPasswords|parse-passwd-1" # key banlist